# USB_MTPDISK_MIDI
## Using Flash cip: W25Q128JV (128M-bit/ 16M-byte)

# Visual Studio IDE / platformio:
## Update Platformio with the last teensyduino framework

  cd ~/.platformio/packages/framework-arduinoteensy
  rm -r cores
  git clone https://github.com/PaulStoffregen/cores.git

## Create USB_MTPDISK_MIDI inerface
cd ~/.platformio/packages/framework-arduinoteensy/cores/teensy4
Edit > usb_desc.h
Add this deffinition:

#elif defined(USB_MTPDISK_MIDI)
  #define VENDOR_ID		            0x16E0
  #define PRODUCT_ID		          0x04D1
  #define MANUFACTURER_NAME	      {'T','e','e','n','s','y','d','u','i','n','o'}
  #define MANUFACTURER_NAME_LEN	  11
  #define PRODUCT_NAME		        {'T','e','e','n','s','y',' ','M','T','P',' ','M','I','D','I'}
  #define PRODUCT_NAME_LEN	      15
  #define EP0_SIZE		            64
  #define NUM_ENDPOINTS           5
  #define NUM_INTERFACE           3
  #define MTP_INTERFACE		        3   /* MTPDISK */
  #define MTP_TX_ENDPOINT	        2
  #define MTP_TX_SIZE_12	        64
  #define MTP_TX_SIZE_480	        512
  #define MTP_RX_ENDPOINT	        2
  #define MTP_RX_SIZE_12	        64
  #define MTP_RX_SIZE_480	        512
  #define MTP_EVENT_ENDPOINT	    3
  #define MTP_EVENT_SIZE	        32
  #define MTP_EVENT_INTERVAL_12	  10
  #define MTP_EVENT_INTERVAL_480  7
  #define SEREMU_INTERFACE        2	  /* SERIAL_EMULATION */
  #define SEREMU_TX_ENDPOINT      4
  #define SEREMU_TX_SIZE          64
  #define SEREMU_TX_INTERVAL      1
  #define SEREMU_RX_ENDPOINT      4
  #define SEREMU_RX_SIZE          32
  #define SEREMU_RX_INTERVAL      2
  #define MIDI_INTERFACE	        1	  /* MIDI */
  #define MIDI_NUM_CABLES	        1
  #define MIDI_TX_ENDPOINT	      5
  #define MIDI_TX_SIZE_12	        64
  #define MIDI_TX_SIZE_480	      512
  #define MIDI_RX_ENDPOINT	      5
  #define MIDI_RX_SIZE_12	        64
  #define MIDI_RX_SIZE_480	      512
  #define ENDPOINT2_CONFIG	      ENDPOINT_RECEIVE_UNUSED + ENDPOINT_TRANSMIT_INTERRUPT
  #define ENDPOINT3_CONFIG	      ENDPOINT_RECEIVE_BULK + ENDPOINT_TRANSMIT_BULK
  #define ENDPOINT4_CONFIG	      ENDPOINT_RECEIVE_UNUSED + ENDPOINT_TRANSMIT_INTERRUPT
  #define ENDPOINT5_CONFIG	      ENDPOINT_RECEIVE_BULK + ENDPOINT_TRANSMIT_BULK
  
  cd ~/.platformio/platforms/teensy/builder/frameworks
  Edit > arduino.py
  Add > USB_MTPDISK_MIDI